<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AR-–ö–≤–∏–∑</title>
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- A-Frame –∏ AR.js -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ -->
    <script>
        window.addEventListener('load', function() {
            console.log('Checking libraries loaded:');
            console.log('A-Frame loaded:', typeof AFRAME !== 'undefined');
            console.log('AR.js loaded:', typeof THREEx !== 'undefined' && typeof THREEx.ArToolkitContext !== 'undefined');
        });
    </script>
    
    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <script src="js/core/state-manager.js"></script>
    <script src="js/core/ar-system.js"></script>
    <script src="js/core/quiz-data.js"></script>
    <script src="js/core/app.js"></script>
</head>
<body>
    <div id="app-container">
        <!-- AR —Å—Ü–µ–Ω–∞ —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ -->
        <a-scene id="ar-scene" embedded 
                arjs="sourceType: webcam; 
                     debugUIEnabled: false; 
                     detectionMode: mono_and_matrix; 
                     maxDetectionRate: 60;
                     canvasWidth: 1280; 
                     canvasHeight: 960;"
                renderer="antialias: true; logarithmicDepthBuffer: true; precision: mediump; alpha: true;"
                vr-mode-ui="enabled: false">
            
            <!-- –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞—Å—Å–µ—è–Ω–Ω—ã–π —Å–≤–µ—Ç –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö -->
            <a-entity light="type: ambient; color: #BBB"></a-entity>
            
            <a-entity id="ar-objects-container"></a-entity>
            <a-entity camera="fov: 40; near: 0.1; far: 10000;" look-controls="reverseMouseDrag: false;" position="0 1.6 0"
                      cursor="rayOrigin: mouse; fuse: false;" 
                      raycaster="objects: .clickable; far: 10000;"></a-entity>
        </a-scene>
        
        <!-- UI –û–≤–µ—Ä–ª–µ–π -->
        <div id="ui-overlay">
            <!-- –ó–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —ç–∫—Ä–∞–Ω -->
            <div id="loading-screen" class="screen">
                <div class="loader"></div>
                <h1>AR-–ö–≤–∏–∑</h1>
                <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
            </div>

            <!-- –≠–∫—Ä–∞–Ω –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ -->
            <div id="name-input-screen" class="screen hidden">
                <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
                <p>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:</p>
                <input type="text" id="playerName" placeholder="–í–∞—à–µ –∏–º—è" class="name-input" maxlength="20">
                <button id="submitName" class="primary-button">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
            </div>
            
            <!-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω -->
            <div id="start-screen" class="screen hidden">
                <h1>AR-–ö–≤–∏–∑</h1>
                <p>–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è AR –∏–≥—Ä–∞</p>
                <div class="button-container">
                    <button id="start-marker" class="primary-button">
                        <img src="assets/icons/marker-icon.svg" alt="" class="button-icon">
                        –ù–∞—á–∞—Ç—å —Å –º–µ—Ç–∫–æ–π
                    </button>
                    <button id="start-location" class="primary-button">
                        <img src="assets/icons/location-icon.svg" alt="" class="button-icon">
                        –ù–∞—á–∞—Ç—å —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
                    </button>
                </div>
            </div>
            
            <!-- –ù–æ–≤—ã–π —ç–∫—Ä–∞–Ω –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –¥–ª—è –º–∞—Ä–∫–µ—Ä–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ -->
            <div id="marker-instructions-screen" class="screen hidden">
                <h2>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</h2>
                <p>–†–∞—Å–ø–µ—á–∞—Ç–∞–π—Ç–µ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ –º–∞—Ä–∫–µ—Ä –Ω–∞ —Å—Ç–æ–ª:</p>
                <div class="marker-container">
                    <img src="assets/icons/hiro-marker.png" alt="–ú–∞—Ä–∫–µ—Ä Hiro" class="marker-image">
                    <a href="assets/icons/hiro-marker.png" download class="download-link">–°–∫–∞—á–∞—Ç—å –¥–ª—è –ø–µ—á–∞—Ç–∏</a>
                </div>
                <p>–ù–∞–ø—Ä–∞–≤—å—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –º–∞—Ä–∫–µ—Ä. –û–±—ä–µ–∫—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –Ω–∞ –Ω—ë–º.</p>
                <button id="start-marker-ar" class="primary-button">–ù–∞—á–∞—Ç—å AR</button>
                <button id="back-to-start" class="secondary-button">–ù–∞–∑–∞–¥</button>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ –ø—Ä–µ–¥–º–µ—Ç–∞ -->
            <div id="subject-screen" class="screen hidden">
                <h2>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç</h2>
                <div class="subject-grid">
                    <div class="subject-card" data-subject="geology">–ì–µ–æ–ª–æ–≥–∏—è</div>
                    <div class="subject-card" data-subject="botany">–ë–æ—Ç–∞–Ω–∏–∫–∞</div>
                    <div class="subject-card" data-subject="anatomy">–ê–Ω–∞—Ç–æ–º–∏—è</div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω —Å —É—Ä–æ–≤–Ω—è–º–∏ -->
            <div id="level-screen" class="screen hidden">
                <h2>–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å</h2>
                <div class="level-grid">
                    <!-- –£—Ä–æ–≤–Ω–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                <button id="back-to-subjects" class="secondary-button">–ù–∞–∑–∞–¥</button>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ AR –¥–ª—è –±–µ–∑–º–∞—Ä–∫–µ—Ä–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ -->
            <div id="ar-instructions-screen" class="screen hidden">
                <h2>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</h2>
                <p>–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –ø–ª–æ—Å–∫—É—é –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å. –û–±—ä–µ–∫—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –≤–æ–∫—Ä—É–≥ –≤–∞—Å.</p>
                <p>–ù–∞–π–¥–∏—Ç–µ –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ñ–µ—Ä—É, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º.</p>
                <button id="start-ar" class="primary-button">–ù–∞—á–∞—Ç—å AR</button>
            </div>
            
            <!-- –ò–≥—Ä–æ–≤–æ–π UI -->
            <div id="game-ui" class="hidden">
                <div id="question-container">
                    <p id="question-text">–í–æ–ø—Ä–æ—Å –±—É–¥–µ—Ç –∑–¥–µ—Å—å</p>
                </div>
                <div id="score-container">
                    <span id="current-score">0</span> / <span id="total-questions">10</span>
                </div>
                <button id="exit-game" class="icon-button">‚úï</button>
                <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –æ—Ç–ª–∞–¥–∫–∏ -->
                <button id="debug-toggle" class="icon-button">üêû</button>
                <!-- –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —è–∫–æ—Ä—è -->
                <button id="anchor-toggle" class="icon-button" style="position: absolute; top: 20px; left: 80px;">üìç</button>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
            <div id="results-screen" class="screen hidden">
                <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
                <p>–í—ã –Ω–∞–±—Ä–∞–ª–∏ <span id="final-score">0</span> –∏–∑ <span id="max-score">10</span></p>
                <button id="restart-game" class="primary-button">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                <button id="show-leaderboard" class="primary-button">–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</button>
                <button id="return-to-menu" class="secondary-button">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
            </div>

            <!-- –≠–∫—Ä–∞–Ω —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤ -->
            <div id="leaderboard-screen" class="screen hidden">
                <h2>–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h2>
                <div id="leaderboard-table-container">
                    <!-- –¢–∞–±–ª–∏—Ü–∞ –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
                </div>
                <button id="back-to-results" class="secondary-button">–ù–∞–∑–∞–¥ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º</button>
                <button id="leaderboard-return-to-menu" class="secondary-button">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
            </div>
        </div>
    </div>
</body>
</html>
